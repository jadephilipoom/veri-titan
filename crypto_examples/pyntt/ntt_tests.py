from forward_ntt import *
from numpy import polysub, save

rev_shoup_scaled_ntt16_12289 = [0,  1479,  4043,  7143,  6553,  8155, 10984, 11567, 1212, 10643,  9094,  5860,  3542,  3504,  3621,  9744]
poly = [1371,8801,5676,4025,3388,10753,6940,10684,10682,2458,679,11161,3648,5512,10142,10189]

fntt16 = ForwardNTT(12289, 16, 1212, 6553)
fntt16.mulntt_ct_std2rev(poly, rev_shoup_scaled_ntt16_12289)

rev_shoup_scaled_ntt1024_12289 = [0,  1479,  4043,  7143,  6553,  8155, 10984, 11567, 11077,  1646,  3195,  6429,  8747,  8785,  8668,  2545, 6461,  7266,  7698,  5728,  3328,  6512, 10938,  4978, 9650,  4821,  9664,   949,  9545,  9283,  2975,   563, 2366,  9238,  4896,  2963,  7969,  1000,  9198, 12208, 8034, 11112,  1635,  9521,   726,  4611, 10436, 12149, 11499, 11334,  1170,  9970,  9088,  9275, 10963,  5086, 11227,  2294,  7484,  8736,  8577,  3135,  9542,  4846, 1381,  2525,  4177,  8705,  4989,  5331,  4278, 10616, 9821, 11950,   544,  5791, 11809,  2842,  1022, 12280, 827,  6522,   953,  8541, 12171,  9813,  2197,  5067, 5374,  9452,   130,  7935,  7837,  2396,  3949,  3296, 10861,  1696,  2426, 11955,  6534,  4632,  7901, 11029, 10276,  9000,  9048, 11560,  7197,  2089,  9408,  3284, 2731,  8357,  5911,  4890,  3459,  3637, 12144,  6747, 8058,  9741,   355,  8907, 10530,  3707,  3694,  7110, 7094,  9509, 10805,  4895,  9984,  7247,  8236,  2645, 4372,  2174,  4414,  2847,  4057,  3271,  8925,  1689, 8653,  4938,  9585,  6998,  1663,  1777,  1426,  7635, 7370, 12176,  8374, 10123, 12129,  9140,  4437, 12286, 9919,  9424,  3510,  5332,  2686,  3247,  8311,  2969, 9103,  6882, 10163,  1630,  1153,  9405,  4048,  2249, 11813,  8758,  4905,  3985,  2178,  1544,  6730, 11869, 11618,  3000,  3016, 12046,  2399,  8889,  3136,  5191, 2481,  7277,  2859,  1045, 11935,  4861,  6591,  2912, 3833,  3778,   390, 11516, 11222,  7188, 11847,  9888, 4885, 11272,  1632,  5084, 10849,  8526,  3066, 12262, 2678,  3704,   545,  7270,   242,  1537,  7575,  8146, 8193,   493,  5444,  2381, 10377, 10911, 11854,  7952, 11885,  4645,  1065,  2143,  7012, 11121, 11082,  9041, 6250,  2422,  2566, 10102,  9302,  6267,  3646,  9852, 7313,  1607, 11414,  8509,  7278, 11287,  5088,  4284, 8209, 11868,  8687,  6068,  4624,  6212,  3263,  8689, 4782,  6403,  3029,  6695, 11785,  4213,  2302,   605, 11314,  8077,  2844,  3438,  1105, 12147,  6608,  3477, 1956,  5009,  6281, 11404,   241,    58,  3532,  1003, 5874, 11612,  6234,  3336,  3174, 12237,  2766, 10966, 8332,  9450,  2127, 12138, 11858,  1579,  2505,  5906, 3482,   787,  6821, 11279,  9162,  8120,  2920,  5241, 7232,  4698,  3445,  7509,  4912,  2049,   192,  1321, 6171,  8471,  2683, 11099,  7753,  1050,  8429,  5445, 4749,  6752,  4789,  4467,  4449,  5456,  8500, 12142, 5315,  8214,  7373,  4324,  2169,   522,  7210,  9027, 9945, 11011, 10316,  6715,  1018,  6364, 11248,  8775, 1254, 11316,  6854, 10930,  8410,  1922, 10256,  3998, 3988, 11821,   316,   382,  6950,  5446,  6196,  8579, 3643,  5415,  6427,  6136,  7341,  6152,  1728, 11889, 8724, 11635,  1702, 10302, 12233,  3199,  7083,  5529, 9364, 11942,  8532, 10314,  3315, 11863,  7535, 10431, 5868,  2738,  6554,  9634,   723,   174, 10596,  3009, 2057,  6920,  9087,  7796, 10777,   350,  6906,  1815, 1583,  6347,  9789,  1489,  1483,  5915, 11026, 12240, 10446,  2361,  8174,  9259,  2908, 12071,  8760,  3434, 9407,  1805, 10335, 10238,  2447,  6147,   576,  3963, 418,  3772,  6381, 11836, 10996,  4737,  7515,  5429, 9522, 12133,  8298,  8320,  6413, 10008, 10258,  6956, 3656,    64,  9830,   683,  6507,  1566,  9341,  2503, 5257,  8455,  6370,  7856,  3054,  6803,  9166,  1747, 1958,  7967,  2078,  1112,  1058,  4079,   922, 11848, 10970,  3150,   709,  4046,  8049,  8719,   835,  6065, 10929,  3956,  6992,  6119,  9734,  6167,  5184, 11089, 1594, 10327,  5106,  6328, 12121,  9597,  8960,  4298, 11964, 10885,   948,  1146,  8561,  4049,  6299,  1159, 652,  5766,  6190, 11994,  8273,  8212,  9370,  8527, 1014,   448,  7365,  4781,  8682, 10962,  3942,  5232, 12221, 10029,  7723,  5836,  9089, 10754,  2717, 12229, 1417,  6613,  2257,  7784,  7406,  3975,  6454,  9202, 3056,  9761,  4963,  3744,  7187, 11877,  5845,  5588, 2769,  3114, 12077,  5966,  6693,  6302, 11710,  3889, 11158, 10844, 11164,  7429, 11113,  5734,  1275,  5508, 10014,  2461,  6636,  8022, 10771,  3765,  7226,  8113, 4564,  3495,  6463, 10224,  8755,  8328,  4145, 10533, 11677,  4238,  8062,  3368,  8067, 10763, 12164, 11749, 4404,   346, 10900, 10221,  4840,  6162,  4032,  3163, 2926,  1826,  7800,  9118,  3238,  8581,  3449,  1136, 5209, 11197,  8930,  9084,  8024,  8611, 10361, 11825, 2110, 11573,  2164,  5416,  1705,  2450, 11475,   416, 11081,  7562,  7078, 10423, 10381,  4538,  3448, 11946, 4209,  6877,  9011,  5993,  5061,  1218,   438,  8774, 10916,  9307,  3589, 11572, 10568, 10753,  9860,  8186, 4251,  7550,  6771, 11063,  9929, 11925,  7073,  3028, 9168,  4705,  2600, 11232,  9272, 11053,  5246,  4475, 12085,  5509, 10880,  5219,  2689,  7684,  8151, 12109, 1468,  8308, 11826,  3407,  9806,  2054,  1344,  9247, 5464,  7383,  7619, 11777,  7735, 11295,  9389, 12050, 1403, 10485,  7100,  6094,  1687,   406,   146,  7021, 8896,  7954,  8914,  9998,  8761,  4913,  3825,  4235, 7790,  6617, 10552, 11667, 11653,  5609,  9342,  3982, 8778,  5478, 11111,  2776,  9714,  1165, 10347,  3408, 3338,  9013,  2212,  2674, 11783,  1255,  6505, 10897, 923,  1038,  8122,  6085,  2231,  6197, 12096,  9489, 11912,  7711, 11914, 10669, 11897, 10104,   425,  1836, 338,  8342,  2455,  5690,  2894,  3654,  1314,  1744, 8170,  3343, 10767, 10138,  7126,  7681,  5002, 12269, 8665, 10397,  8945,  6691,  6565,  1325, 10344, 11260, 5115,  7350,  9847,  1248,  6492,  3959, 10141,  5959, 4273,  3221,  9694,  8452,  6627,  7000,  2941, 11722, 7082,  4050, 11445,  5202,  5082,  7699, 11607, 11309, 6759,  5604,  8190,  8345,  2171,  3480,  3007, 11024, 4855,  3769,  3232, 11996, 10883,  9656,  5349,  9344, 8360,  1706,  4730,  3229, 11007,  8717,  2832, 10268, 6105,  9169,  6203,  6643,  5370,  3536,  8536,  3941, 3805, 11522, 10076,  8136, 12073,    50, 11520,  5526, 9004,  7929,  3154,  7235,  3723,   845, 10353, 12282, 2293, 11872,  4693,  9951,  8871,  7846,  6151,  3469, 10487,  1555,  1891,  7186,  1223,  2334,  4411, 10699, 6828,  9343,  4510,  9652, 11924,   881, 11274, 10362, 7250,  6742,  2485,   904, 12265,  1371,  1280,   614, 5789,  8787,  6671, 10631, 11463,  7246,  3090, 10891, 751,  4719,   910,  6389,  5703,  4483,  3065, 10783, 7302,  9916,  3808,  3670,  8929,  7605,  7154, 12226, 10345,   450,  5368,   578,  4661, 11779,  5386,  2622, 7988,  4523, 12281,   457,  6513, 10440,  9021,  8494, 2276, 11307,  9696, 11410,  8071,  4390,  3758,  3454, 8957, 12150,  9757,  3317,  2957, 10808, 10243,  9349, 7592,  8711,  8823, 10588,  4504,   778,  9663, 11759, 11415,  9988,  5650, 12119, 11641,   150,  9982,  4289, 2434, 11498,  9462,  9416, 11169,  2535,  6481, 12268, 6026,  2929,  6320,  7640,  3821, 10608,  1030, 11823, 8443,  1573,  8496,  6226,  1901,  9687,  5118, 11787, 8195,  3451,  1241,  4378, 11194,  2643,  9244,  6508, 9461,  7937,  7455,  2712, 12217,  4113,  3840,  1842, 6883,  4665,  5673,  9269,  3669,  7002,   944,  7519, 2035, 11249,  6164, 10407,  1790,  5275, 11038,  5410, 9617,  5170, 11424, 11010,  2209, 10526,  9173, 12100, 6457,  1350,  3815,  1734,  1694, 10759,  3869,  7866, 2253,  1868,  2730,  6878,  4820,  1160,  9195,  7771, 9811,  9449,  9270,  8095,  7724,  7315,  1783,  7211]
poly = [2033, 12220, 8359, 1781, 9223, 4491, 2129, 5011, 877, 5290, 1526, 6873, 9797, 4709, 3427, 5387, 6919, 5002, 6604, 3272, 6303, 8371, 9859, 8602, 884, 11128, 10591, 7220, 9789, 5055, 6580, 10091, 1482, 645, 6367, 9859, 4356, 6246, 5292, 320, 11454, 10176, 6734, 6311, 10963, 7446, 2461, 2783, 6312, 3324, 1767, 4765, 2282, 7289, 11586, 12076, 5489, 7881, 11189, 11332, 10087, 3857, 5812, 11457, 4373, 283, 5160, 9233, 6460, 6853, 8963, 8650, 6195, 5908, 8304, 9225, 7945, 1159, 2696, 4858, 2849, 10702, 1805, 7008, 8345, 2619, 8190, 8472, 12099, 2006, 9604, 10001, 11996, 122, 10990, 9403, 2164, 1219, 2924, 9307, 5944, 2454, 6631, 4946, 8976, 5472, 10610, 2553, 10517, 236, 6498, 6811, 10463, 6850, 1026, 2790, 1221, 7427, 1731, 5690, 380, 10734, 11415, 11662, 9420, 1941, 2905, 10499, 5631, 862, 10381, 10838, 1808, 1957, 11623, 653, 1610, 866, 4301, 2953, 5797, 3818, 8598, 3981, 2101, 6422, 7395, 3671, 10847, 2858, 2236, 2385, 7244, 10666, 9262, 8678, 2755, 1980, 11080, 5354, 4023, 3253, 9337, 4254, 3074, 2891, 3343, 2986, 1906, 4024, 420, 4711, 6123, 9637, 3920, 9721, 10456, 4629, 198, 2071, 8787, 527, 2092, 7790, 8941, 9086, 5802, 11386, 6936, 911, 789, 5390, 9077, 10901, 400, 10550, 2359, 572, 7255, 8493, 8917, 1398, 1253, 6163, 9300, 4861, 11950, 3526, 2197, 9806, 3185, 2126, 10427, 5922, 5305, 4292, 4472, 3058, 4720, 203, 7884, 8271, 3651, 2918, 9779, 10835, 7478, 4731, 8399, 2778, 6652, 2215, 1130, 3952, 3088, 360, 4722, 11881, 8780, 10281, 1969, 2788, 8974, 9599, 61, 5635, 3090, 9225, 7571, 365, 11429, 11414, 4180, 11284, 8257, 5181, 5881, 7472, 6257, 6030, 9117, 9277, 9625, 5311, 4404, 3419, 138, 931, 604, 3043, 993, 286, 369, 8518, 635, 2290, 9960, 7856, 9863, 7372, 9251, 1351, 7227, 1745, 6495, 3836, 8226, 2837, 3008, 5523, 9460, 6017, 3970, 9350, 11653, 5588, 5814, 10483, 10991, 1756, 6858, 319, 4708, 11069, 7334, 10810, 4414, 8809, 9197, 11938, 4588, 8567, 10976, 367, 4688, 5704, 7330, 1907, 10442, 10198, 743, 3228, 4568, 7711, 8693, 8948, 9292, 6782, 9726, 4882, 179, 8273, 9461, 4045, 7704, 10514, 1098, 5119, 3194, 2031, 11077, 2441, 6161, 12286, 11486, 6193, 3578, 216, 9609, 5305, 1092, 3160, 3905, 5469, 1526, 8986, 7083, 11456, 8384, 10892, 5443, 306, 4237, 11241, 11249, 2420, 2752, 1501, 11722, 11248, 4298, 833, 9119, 8286, 10632, 7556, 2234, 9209, 6498, 5522, 5771, 307, 9559, 2188, 343, 776, 4275, 11413, 10500, 8748, 5386, 756, 4516, 7547, 6009, 4407, 8927, 11799, 7939, 5096, 6426, 11525, 8260, 1114, 10572, 7395, 3464, 10464, 10243, 10861, 1380, 6229, 8174, 8786, 3817, 8360, 3358, 2292, 11722, 11505, 3067, 47, 9618, 3676, 3491, 1927, 6641, 12172, 10166, 10356, 11254, 5362, 8548, 11664, 11354, 8278, 1918, 7647, 5800, 7849, 6116, 638, 2253, 5501, 8992, 7231, 3457, 3392, 7134, 1887, 10919, 11205, 7431, 5732, 8729, 10340, 42, 8852, 7420, 469, 10874, 11979, 12002, 7537, 10649, 5349, 8088, 11620, 5717, 9711, 3268, 4825, 10268, 5436, 11634, 1845, 10681, 1419, 2583, 3970, 12092, 6922, 3440, 9251, 2589, 3657, 8570, 6526, 4187, 8855, 3140, 1492, 1661, 8865, 5981, 9734, 7282, 8196, 4564, 4812, 2852, 6214, 7519, 4383, 3720, 2909, 10187, 5792, 4133, 5673, 3830, 8082, 3044, 8769, 155, 7914, 431, 11243, 8653, 2634, 5685, 1036, 9016, 12200, 8749, 11943, 4543, 7496, 10771, 4810, 11064, 565, 721, 7468, 11828, 8493, 1830, 1487, 1578, 3376, 3626, 656, 2960, 9338, 12155, 6693, 649, 3237, 9024, 3133, 2156, 1934, 827, 1173, 10959, 7089, 6257, 11059, 2828, 11871, 1503, 8070, 205, 6605, 12284, 290, 1434, 3573, 659, 2736, 2753, 12171, 6574, 5829, 3715, 3686, 5466, 7782, 6517, 7569, 7154, 1487, 2164, 119, 11990, 6296, 7696, 8185, 3077, 8689, 496, 3115, 4234, 96, 3772, 1567, 498, 5191, 5250, 6345, 4861, 8310, 11126, 3020, 1947, 2840, 11527, 5733, 1413, 8763, 1953, 8338, 7402, 1273, 600, 8508, 4577, 1318, 3301, 9383, 9239, 10899, 6009, 8182, 11659, 6025, 610, 7412, 2725, 1453, 1915, 7681, 10011, 1231, 2699, 10690, 12091, 444, 8097, 3208, 3531, 11252, 2596, 6724, 2045, 6540, 10276, 5900, 3820, 1573, 10844, 350, 3059, 2547, 414, 2478, 10212, 1865, 3938, 5668, 5758, 4415, 5977, 6047, 11719, 11655, 3678, 2146, 7949, 4689, 4797, 7171, 11042, 4029, 3165, 8208, 3373, 10305, 379, 9678, 8634, 2630, 2797, 7917, 2393, 9649, 514, 7286, 1370, 4611, 8949, 5933, 3430, 4422, 6496, 9486, 9683, 687, 10814, 2892, 5035, 12083, 9247, 1417, 3890, 6265, 8199, 10483, 11122, 10313, 9625, 7301, 1551, 11834, 953, 3410, 6327, 10117, 10832, 8707, 7664, 5211, 4019, 3108, 3630, 8636, 8234, 1366, 11477, 6840, 10439, 4607, 7345, 1821, 5287, 7198, 5008, 5030, 2554, 7515, 8963, 3879, 3478, 9793, 3103, 6690, 305, 4409, 6992, 7158, 3649, 7858, 9400, 9208, 6612, 11005, 5820, 1923, 7102, 2396, 5921, 11073, 11868, 9155, 9826, 1713, 8797, 5509, 8282, 530, 835, 6709, 6622, 6556, 9871, 6404, 1175, 2004, 4208, 10280, 1810, 6281, 2380, 11374, 4936, 4192, 5112, 10341, 4382, 6762, 8568, 5766, 9175, 917, 2013, 12190, 9453, 192, 4293, 2752, 2219, 12212, 11025, 1033, 2064, 10829, 3789, 7513, 5852, 10406, 10365, 2338, 753, 285, 999, 4086, 5015, 11189, 5046, 1932, 8968, 3883, 1865, 8975, 4151, 489, 4324, 10923, 11397, 5185, 6983, 10807, 10393, 928, 8101, 11387, 3727, 9902, 2321, 4240, 4652, 6029, 5210, 5448, 2148, 6223, 3212, 1144, 7949, 1036, 3070, 5739, 617, 3968, 2606, 7345, 5179, 8406, 11923, 3934, 6915, 11099, 5905, 5264, 2064, 10863, 4096, 3353, 4474, 5454, 10429, 652, 11479, 8478, 9316, 9993, 6619, 2531, 10705, 5386, 12078, 7140, 5168, 12198, 10587, 9536, 9136, 12207, 11775, 6037, 2697, 4186, 5507, 10191, 6035, 5269, 10272, 4862, 6031, 7522, 2869, 11837, 8828, 5599, 11179, 7420, 5889, 11004, 9012, 932, 487, 8578, 2827, 4414, 5035, 4262, 8176, 3563, 6510, 5658, 3565, 11484, 3841, 3531, 7791, 6817, 3562, 5300, 904, 8491, 6743, 1650, 3251, 8496, 11456, 5797, 10713, 7919, 1635, 2845, 9436, 7175, 3826, 1295, 1839, 11564, 6149, 436, 455, 9233, 3390, 3674, 11904, 5412, 12272, 9043, 1167, 6813, 11911, 1563, 2539, 5175, 1511, 1845, 9131, 12068, 372, 4530, 3344, 7680, 11201, 90, 10651, 6274, 10887, 8338, 11590, 4417, 12013, 1092, 8781, 971, 3205, 2984, 5420, 6322, 10579, 11569, 7074, 4830, 5540, 5960, 11091, 4483, 8624, 8928, 9273, 5124, 5205, 2743, 6081, 7648, 6646, 6771, 9532, 2659, 11046, 2560, 8426, 6983, 11121, 6178, 7010, 9449, 2311, 3630, 5376, 4683, 3128, 1382, 3403, 2540, 979, 12277]
fntt1024 = ForwardNTT(12289, 1024, 1014, 8209)
fntt1024.mulntt_ct_std2rev(poly, rev_shoup_scaled_ntt1024_12289, True)
